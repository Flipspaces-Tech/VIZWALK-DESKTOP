{"version":3,"file":"static/js/221.0f3a05b5.chunk.js","mappings":"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","sources":["pages/Experience.jsx"],"sourcesContent":["// src/pages/experience/Experience.jsx\r\nimport React, {\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n  useMemo,\r\n  useCallback,\r\n} from \"react\";\r\n\r\n// ====== FILL THIS IN after you deploy the Apps Script web app (must end with /exec) ======\r\nconst GDRIVE_API_URL =\r\n  \"https://script.google.com/macros/s/AKfycbxcVqr7exlAGvAVSh672rB_oG7FdL0W0ymkRb_6L7A8awu7gqYDInR_6FLczLNkpr0B/exec\";\r\n\r\nfunction getQuery(key, def = \"\") {\r\n  const u = new URL(window.location.href);\r\n  return u.searchParams.get(key) || def;\r\n}\r\n\r\n// âœ… phase-specific text (defaults match your dashboard)\r\nconst LOADER_TEXT = {\r\n  connecting: getQuery(\r\n    \"msg1\",\r\n    \"Starting connection to Vizwalk server, please wait\"\r\n  ),\r\n  launching: getQuery(\r\n    \"msg2\",\r\n    \"Almost there, hold tightâ€”awesomeness loading\"\r\n  ),\r\n  finalizing: getQuery(\"msg3\", \"Sharpening pixels and buffing the detailsâ€¦\"),\r\n};\r\n\r\n// ---------- Helpers for robust boolean + early message handling ----------\r\nconst toBool = (v) => {\r\n  if (typeof v === \"boolean\") return v;\r\n  if (typeof v === \"number\") return v !== 0;\r\n  if (typeof v === \"string\") {\r\n    const s = v.trim().toLowerCase();\r\n    return s === \"true\" || s === \"1\" || s === \"yes\" || s === \"on\";\r\n  }\r\n  return !!v;\r\n};\r\n// If UE tells us desired hover before UIControlApp is ready, store it and apply later\r\nlet pendingHoverEnabled = null;\r\n\r\n// ---------- Apps Script fetch + resolver (with strong diagnostics) ----------\r\nasync function getJsonVerbose(url, params = {}) {\r\n  const u = new URL(url);\r\n  Object.entries(params).forEach(([k, v]) => {\r\n    if (v !== undefined && v !== null && String(v).trim() !== \"\") {\r\n      u.searchParams.set(k, String(v));\r\n    }\r\n  });\r\n\r\n  let resp, text;\r\n  try {\r\n    resp = await fetch(u.toString(), { method: \"GET\" });\r\n  } catch (e) {\r\n    throw new Error(`Network error to ${u}: ${e?.message || e}`);\r\n  }\r\n\r\n  try {\r\n    const data = await resp.clone().json();\r\n    if (!resp.ok || data?.ok === false) {\r\n      throw new Error(data?.error || `HTTP ${resp.status}`);\r\n    }\r\n    return data;\r\n  } catch {\r\n    text = await resp.text().catch(() => \"\");\r\n    throw new Error(\r\n      `Expected JSON from Apps Script but got: ${\r\n        text?.slice(0, 300) || \"(no body)\"\r\n      } (HTTP ${resp?.status})`\r\n    );\r\n  }\r\n}\r\n\r\n// Resolve appId:\r\n// 1) URL ?appId=... (highest priority)\r\n// 2) Google Sheet via Apps Script: action=getappid&build=<build>\r\n// 3) Last-resort hardcoded fallback\r\nasync function resolveAppId(buildName) {\r\n  const urlOverride = getQuery(\"appId\", \"\").trim();\r\n  if (urlOverride) return urlOverride;\r\n\r\n  const data = await getJsonVerbose(GDRIVE_API_URL, {\r\n    action: \"getappid\",\r\n    build: buildName,\r\n  });\r\n  if (data?.appId && typeof data.appId === \"string\") return data.appId;\r\n\r\n  throw new Error(\"No appId in response JSON\");\r\n}\r\n\r\n/** =============== 3-phase loader overlay (PNG/GIF; with corner text) =============== */\r\nfunction LoaderOverlay({ phase }) {\r\n  // call hooks unconditionally\r\n  const imgRef = React.useRef(null);\r\n  const [scaleX, setScaleX] = React.useState(1);\r\n  const [scaleY, setScaleY] = React.useState(1);\r\n\r\n  const recalc = React.useCallback(() => {\r\n    const img = imgRef.current;\r\n    if (!img || !img.naturalWidth || !img.naturalHeight) return;\r\n\r\n    const vw = window.innerWidth,\r\n      vh = window.innerHeight;\r\n    const viewAR = vw / vh;\r\n    const imgAR = img.naturalWidth / img.naturalHeight;\r\n\r\n    const neededScaleX = viewAR > imgAR ? viewAR / imgAR : 1;\r\n    setScaleX(neededScaleX);\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    const onResize = () => recalc();\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, [recalc]);\r\n\r\n  // decide visibility AFTER hooks\r\n  const show = !!phase && phase !== \"ready\";\r\n  if (!show) return null;\r\n\r\n  const src =\r\n    phase === \"connecting\"\r\n      ? \"/gifs/conn.png\"\r\n      : phase === \"launching\"\r\n      ? \"/gifs/conn.png\"\r\n      : \"/gifs/conn.png\";\r\n\r\n  return (\r\n    <div\r\n      id=\"sp-loader\"\r\n      style={{\r\n        position: \"fixed\",\r\n        inset: 0,\r\n        backgroundColor: \"#000\",\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n        zIndex: 9999,\r\n        overflow: \"hidden\",\r\n      }}\r\n    >\r\n      <img\r\n        ref={imgRef}\r\n        src={src}\r\n        alt={phase}\r\n        onLoad={recalc}\r\n        style={{\r\n          width: \"100%\",\r\n          height: \"100%\",\r\n          \r\n          transform: `scaleX(${scaleX}),scaleY(${scaleY})`,\r\n          transformOrigin: \"center\",\r\n          display: \"block\",\r\n          userSelect: \"none\",\r\n          pointerEvents: \"none\",\r\n        }}\r\n      />\r\n\r\n      <div\r\n        style={{\r\n          position: \"fixed\",\r\n          top: \"40px\",\r\n          left: \"50px\",\r\n          maxWidth: \"40vw\",\r\n          color: \"#fff\",\r\n          padding: \"10px 14px\",\r\n          borderRadius: \"10px\",\r\n          fontSize: \"24px\",\r\n          lineHeight: 1.35,\r\n          backdropFilter: \"blur(4px)\",\r\n          WebkitBackdropFilter: \"blur(4px)\",\r\n          boxShadow: \"0 4px 18px rgba(0,0,0,0.35)\",\r\n        }}\r\n      >\r\n        {LOADER_TEXT[phase] || \"\"}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Upload EC2 screenshot URL to Apps Script â†’ Drive ---\r\nasync function uploadScreenshotUrlToDrive(imageUrl, buildName, sessionId) {\r\n  if (!GDRIVE_API_URL) return;\r\n\r\n  try {\r\n    console.log(\"Uploading screenshot URL to Drive:\", imageUrl);\r\n\r\n    const form = new FormData();\r\n    form.append(\"action\", \"saveScreenshotUrl\");\r\n    form.append(\"buildName\", buildName);\r\n    form.append(\"sessionId\", sessionId);\r\n    form.append(\"imageUrl\", imageUrl);\r\n\r\n    const res = await fetch(GDRIVE_API_URL, {\r\n      method: \"POST\",\r\n      body: form, // <-- NO headers, browser sets multipart/form-data\r\n    });\r\n\r\n    let data = null;\r\n    try {\r\n      data = await res.json();\r\n    } catch (e) {\r\n      console.log(\"No JSON response (ok for now)\", e);\r\n    }\r\n\r\n    console.log(\"Drive upload result:\", data);\r\n    return data;\r\n  } catch (err) {\r\n    console.error(\"uploadScreenshotUrlToDrive error\", err);\r\n    return null;\r\n  }\r\n}\r\n\r\n/** ======================================================================== */\r\n\r\n// SDK singletons; will be dropped on unmount\r\nlet PixelStreamingApp;\r\nlet PixelStreamingUiApp;\r\nlet UIControlApp;\r\n\r\nexport default function Experience() {\r\n  const videoWrapRef = useRef(null);\r\n  const connectingRef = useRef(false);\r\n  const mountedRef = useRef(false);\r\n\r\n  const [hoverEnabled, setHoverEnabled] = useState(true);\r\n  const [firstUploadDone, setFirstUploadDone] = useState(false);\r\n\r\n  // Track real user interaction + queued sequence\r\n  const userInteractedRef = useRef(false);\r\n  const pendingSequenceRef = useRef(false);\r\n  const sequenceRunningRef = useRef(false);\r\n\r\n\r\n  // loader phase\r\n  const [phase, setPhase] = useState(\"connecting\");\r\n\r\n  // debug banners (for appId resolution)\r\n  const [appIdError, setAppIdError] = useState(\"\");\r\n  const [resolvedAppIdPreview, setResolvedAppIdPreview] = useState(\"\");\r\n\r\n  const buildName = useMemo(() => getQuery(\"build\", \"Build\"), []);\r\n  const sessionId = useMemo(\r\n    () => getQuery(\"session\", \"session-\" + Date.now()),\r\n    []\r\n  );\r\n\r\n  // --- Helper: infer a clean filename from a URL or fall back to timestamp\r\n  const filenameFromUrl = (url, fallbackExt = \".png\") => {\r\n    try {\r\n      const u = new URL(url);\r\n      const last = u.pathname.split(\"/\").pop() || \"\";\r\n      const clean = last.split(\"?\")[0] || \"\";\r\n      if (clean) return clean;\r\n    } catch {}\r\n    return `screenshot-${new Date()\r\n      .toISOString()\r\n      .replace(/[:.]/g, \"-\")}${fallbackExt}`;\r\n  };\r\n\r\n  // --- Helper: does a string look like a direct image URL?\r\n  const looksLikeHttpImageUrl = (s) => {\r\n    if (typeof s !== \"string\") return false;\r\n    const str = s.trim();\r\n    if (!/^https?:\\/\\//i.test(str)) return false;\r\n    return /\\.(png|jpe?g|webp|gif)(\\?.*)?$/i.test(str);\r\n  };\r\n\r\n  // --- Robust downloader with HTTPâ†’HTTPS proxy support\r\n  const isHttpInsecure = (url) => /^http:\\/\\//i.test(String(url || \"\").trim());\r\n\r\n  const proxyHttpsDownload = (insecureUrl) => {\r\n    const u = new URL(GDRIVE_API_URL);\r\n    u.searchParams.set(\"action\", \"proxyget\");\r\n    u.searchParams.set(\"url\", insecureUrl);\r\n    u.searchParams.set(\"mode\", \"redirect\"); // fast redirect mode\r\n    const finalUrl = u.toString();\r\n    console.log(\"Opening proxy:\", finalUrl);\r\n    window.open(finalUrl, \"_blank\", \"noopener,noreferrer\");\r\n  };\r\n\r\n  const downloadUrlSmart = useCallback(\r\n    async (url, filenameHint) => {\r\n      const name = filenameHint || filenameFromUrl(url);\r\n\r\n      if (isHttpInsecure(url)) {\r\n        proxyHttpsDownload(url);\r\n        return true;\r\n      }\r\n\r\n      try {\r\n        const res = await fetch(url, { mode: \"cors\" });\r\n        if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n        const blob = await res.blob();\r\n\r\n        const a = document.createElement(\"a\");\r\n        a.href = URL.createObjectURL(blob);\r\n        a.download = name;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        a.remove();\r\n        URL.revokeObjectURL(a.href);\r\n        return true;\r\n      } catch (e) {\r\n        console.warn(\"CORS/Fetch failed, opening URL directly:\", e);\r\n        window.open(url, \"_blank\", \"noopener,noreferrer\");\r\n        return false;\r\n      }\r\n    },\r\n    [] // no deps\r\n  );\r\n\r\n  const downloadDataUrl = useCallback(async (dataUrl, filename) => {\r\n    try {\r\n      const res = await fetch(dataUrl);\r\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n      const blob = await res.blob();\r\n      const a = document.createElement(\"a\");\r\n      a.href = URL.createObjectURL(blob);\r\n      a.download = filename;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      a.remove();\r\n      URL.revokeObjectURL(a.href);\r\n    } catch (e) {\r\n      console.warn(\"downloadDataUrl fallback open:\", e);\r\n      window.open(dataUrl, \"_blank\", \"noopener,noreferrer\");\r\n    }\r\n  }, []);\r\n\r\n  const attachVideoAutoplaySafe = useCallback((rootEl) => {\r\n    if (!videoWrapRef.current || !rootEl) return;\r\n\r\n    videoWrapRef.current.innerHTML = \"\";\r\n    videoWrapRef.current.append(rootEl);\r\n\r\n    const videoEl = videoWrapRef.current.querySelector(\"video\");\r\n    if (!videoEl) return;\r\n\r\n    videoEl.muted = true;\r\n    videoEl.autoplay = true;\r\n    videoEl.playsInline = true;\r\n    videoEl.tabIndex = 0;\r\n\r\n    const tryPlay = () => videoEl.play?.().catch(() => {});\r\n    tryPlay();\r\n    videoEl.addEventListener(\"canplay\", tryPlay, { once: true });\r\n\r\n    const onFirstFrame = () => {\r\n      setPhase(\"ready\");\r\n      const overlay = document.getElementById(\"sp-loader\");\r\n      if (overlay) {\r\n        overlay.style.opacity = \"0\";\r\n        setTimeout(() => overlay.remove(), 380);\r\n      }\r\n    };\r\n    videoEl.addEventListener(\"playing\", onFirstFrame, { once: true });\r\n\r\n    const unmuteOnce = () => {\r\n      videoEl.muted = false;\r\n      videoEl.removeEventListener(\"pointerdown\", unmuteOnce);\r\n    };\r\n    videoEl.addEventListener(\"pointerdown\", unmuteOnce, { once: true });\r\n  }, []);\r\n\r\n  // === Synthetic input helpers (I key + left click) ===\r\n  const sendKeyI = useCallback(\r\n    (type = \"keydown\") => {\r\n      const target =\r\n        videoWrapRef.current?.querySelector(\"canvas, video\") ||\r\n        videoWrapRef.current ||\r\n        window;\r\n\r\n      if (!target) return;\r\n\r\n      const evt = new KeyboardEvent(type, {\r\n        key: \"i\",\r\n        code: \"KeyI\",\r\n        keyCode: 73,\r\n        which: 73,\r\n        bubbles: true,\r\n        cancelable: true,\r\n      });\r\n\r\n      target.dispatchEvent(evt);\r\n    },\r\n    [videoWrapRef]\r\n  );\r\n\r\n  const sendLeftClick = useCallback(() => {\r\n    const target =\r\n      videoWrapRef.current?.querySelector(\"canvas, video\") ||\r\n      videoWrapRef.current ||\r\n      document.body;\r\n\r\n    if (!target || !target.getBoundingClientRect) return;\r\n\r\n    const rect = target.getBoundingClientRect();\r\n    const cx = rect.left + rect.width / 2;\r\n    const cy = rect.top + rect.height / 2;\r\n\r\n    const makeEvent = (type) =>\r\n      new MouseEvent(type, {\r\n        bubbles: true,\r\n        cancelable: true,\r\n        clientX: cx,\r\n        clientY: cy,\r\n        button: 0, // left button\r\n        buttons: 1,\r\n      });\r\n\r\n    target.dispatchEvent(makeEvent(\"mousedown\"));\r\n    target.dispatchEvent(makeEvent(\"mouseup\"));\r\n    target.dispatchEvent(makeEvent(\"click\"));\r\n  }, [videoWrapRef]);\r\n\r\n  const runIKeyClickSequence = useCallback(() => {\r\n  if (sequenceRunningRef.current) return;\r\n  sequenceRunningRef.current = true;\r\n\r\n  // STEP 1: I (OPEN)\r\n  sendKeyI(\"keydown\");\r\n  sendKeyI(\"keyup\");\r\n\r\n  // STEP 2: Left-click after a short delay\r\n  setTimeout(() => {\r\n    sendLeftClick();\r\n\r\n    // STEP 3: I (CLOSE) after another delay\r\n    setTimeout(() => {\r\n      sendKeyI(\"keydown\");\r\n      sendKeyI(\"keyup\");\r\n\r\n      sequenceRunningRef.current = false;\r\n    }, 100); // delay between click and second I\r\n  }, 200); // delay between first I and click\r\n}, [sendKeyI, sendLeftClick]);\r\n\r\n\r\n\r\n  const handleResponseApp = useCallback(\r\n    async (response) => {\r\n      try {\r\n        console.log(\"Received unreal message:\", response);\r\n\r\n        // Helper: decide whether to send to Drive (EC2 http://) or download directly (https)\r\n        const forwardImageUrl = async (url) => {\r\n          const val = (url || \"\").trim();\r\n          if (!val) return;\r\n          if (isHttpInsecure(val)) {\r\n            // http:// EC2 â†’ Apps Script â†’ Drive\r\n            await uploadScreenshotUrlToDrive(val, buildName, sessionId);\r\n          } else {\r\n            // https:// etc â†’ normal browser download\r\n            await downloadUrlSmart(val, filenameFromUrl(val));\r\n          }\r\n        };\r\n\r\n        // -------------------------------------------------\r\n        // 0) Raw string payloads\r\n        // -------------------------------------------------\r\n        if (typeof response === \"string\") {\r\n          // (a) plain URL string (EC2 screenshot, S3, etc.)\r\n          if (looksLikeHttpImageUrl(response)) {\r\n            await forwardImageUrl(response);\r\n            return;\r\n          }\r\n\r\n          // (b) otherwise try to parse as JSON\r\n          try {\r\n            response = JSON.parse(response);\r\n          } catch {\r\n            // not JSON, nothing more to do\r\n            return;\r\n          }\r\n        }\r\n\r\n        const msg = response;\r\n        if (!msg || typeof msg !== \"object\") return;\r\n\r\n        // -------------------------------------------------\r\n        // 1) Mouse cursor visibility\r\n        // -------------------------------------------------\r\n        if (Object.prototype.hasOwnProperty.call(msg, \"showMouseCursor\")) {\r\n          const enabled = toBool(msg.showMouseCursor);\r\n\r\n          setHoverEnabled(enabled);\r\n          if (UIControlApp?.toggleHoveringMouse) {\r\n            UIControlApp.toggleHoveringMouse(enabled);\r\n          } else {\r\n            pendingHoverEnabled = enabled;\r\n          }\r\n\r\n          // When UE sends {\"showMouseCursor\":\"false\"}\r\n          if (enabled === false) {\r\n            if (userInteractedRef.current) {\r\n              runIKeyClickSequence();\r\n            } else {\r\n              // queue until first real click\r\n              pendingSequenceRef.current = true;\r\n            }\r\n          }\r\n\r\n          return;\r\n        }\r\n\r\n        if (msg.type === \"showMouseCursor\") {\r\n          const enabled = toBool(msg.value);\r\n          setHoverEnabled(enabled);\r\n          if (UIControlApp?.toggleHoveringMouse) {\r\n            UIControlApp.toggleHoveringMouse(enabled);\r\n          } else {\r\n            pendingHoverEnabled = enabled;\r\n          }\r\n          return;\r\n        }\r\n\r\n        // -------------------------------------------------\r\n        // 2) Screenshot URL callback (savedScreenshotUrl)\r\n        //    â€“ can be EC2 http:// or data URL\r\n        // -------------------------------------------------\r\n        if (\r\n          msg.type === \"savedScreenshotUrl\" ||\r\n          typeof msg.savedScreenshotUrl === \"string\" ||\r\n          typeof msg.value === \"string\"\r\n        ) {\r\n          const raw =\r\n            (typeof msg.savedScreenshotUrl === \"string\" &&\r\n              msg.savedScreenshotUrl) ||\r\n            (typeof msg.value === \"string\" && msg.value) ||\r\n            \"\";\r\n\r\n          if (raw) {\r\n            const val = raw.trim();\r\n            if (looksLikeHttpImageUrl(val)) {\r\n              // EC2/S3 style URL\r\n              await forwardImageUrl(val);\r\n            } else {\r\n              // data:image/...;base64,....\r\n              const urlFilename =\r\n                val.split(\"/\").pop()?.split(\"?\")[0] || filenameFromUrl(val);\r\n              await downloadDataUrl(val, urlFilename);\r\n            }\r\n            return;\r\n          }\r\n        }\r\n\r\n        // 2b) Fallback: raw savedScreenshotUrl field without type\r\n        if (typeof msg.savedScreenshotUrl === \"string\") {\r\n          const val = msg.savedScreenshotUrl.trim();\r\n          if (looksLikeHttpImageUrl(val)) {\r\n            await forwardImageUrl(val);\r\n          } else {\r\n            const urlFilename =\r\n              val.split(\"/\").pop()?.split(\"?\")[0] || filenameFromUrl(val);\r\n            await downloadDataUrl(val, urlFilename);\r\n          }\r\n          return;\r\n        }\r\n\r\n        // -------------------------------------------------\r\n        // 3) Generic JSON fields that may contain an image URL\r\n        // -------------------------------------------------\r\n        const possibleUrl =\r\n          (typeof msg.url === \"string\" && msg.url) ||\r\n          (typeof msg.link === \"string\" && msg.link) ||\r\n          (typeof msg.s3Url === \"string\" && msg.s3Url) ||\r\n          (typeof msg.ec2Url === \"string\" && msg.ec2Url) ||\r\n          (typeof msg.http === \"string\" && msg.http) ||\r\n          (typeof msg.value === \"string\" && msg.value) ||\r\n          \"\";\r\n\r\n        if (looksLikeHttpImageUrl(possibleUrl)) {\r\n          await forwardImageUrl(possibleUrl);\r\n          return;\r\n        }\r\n\r\n        // -------------------------------------------------\r\n        // 4) Raw image payloads (data URLs / base64)\r\n        // -------------------------------------------------\r\n        let data =\r\n          msg.dataUrl || msg.base64 || msg.imageData || msg.png || msg.jpg;\r\n        if (data) {\r\n          if (typeof data === \"string\" && !data.startsWith(\"data:image/\")) {\r\n            data = \"data:image/png;base64,\" + data;\r\n          }\r\n\r\n          const filename =\r\n            msg.filename ||\r\n            `screenshot-${new Date()\r\n              .toISOString()\r\n              .replace(/[:.]/g, \"-\")}.png`;\r\n          await downloadDataUrl(data, filename);\r\n\r\n          if (GDRIVE_API_URL && GDRIVE_API_URL.startsWith(\"http\")) {\r\n            const res = await fetch(GDRIVE_API_URL, {\r\n              method: \"POST\",\r\n              headers: { \"Content-Type\": \"application/json\" },\r\n              body: JSON.stringify({\r\n                buildName,\r\n                sessionId,\r\n                imageDataUrl: data,\r\n                stamp: filename.replace(/\\.png$/i, \"\"),\r\n              }),\r\n            })\r\n              .then((r) => r.json())\r\n              .catch(() => null);\r\n\r\n            if (res?.ok && !firstUploadDone) {\r\n              setFirstUploadDone(true);\r\n              const galleryUrl = `${window.location.origin}/gallery?build=${encodeURIComponent(\r\n                res.build || buildName\r\n              )}&session=${encodeURIComponent(\r\n                res.session || sessionId\r\n              )}&folder=${encodeURIComponent(res.folderId || \"\")}`;\r\n              window.open(galleryUrl, \"_blank\", \"noopener,noreferrer\");\r\n            } else if (!res?.ok) {\r\n              console.warn(\"Drive upload failed (dataUrl path):\", res);\r\n            }\r\n          }\r\n          return;\r\n        }\r\n\r\n        // -------------------------------------------------\r\n        // (no known payload type)\r\n        // -------------------------------------------------\r\n      } catch (e) {\r\n        console.error(\"handleResponseApp error:\", e, response);\r\n      }\r\n    },\r\n    [\r\n      downloadDataUrl,\r\n      downloadUrlSmart,\r\n      buildName,\r\n      sessionId,\r\n      firstUploadDone,\r\n      runIKeyClickSequence,\r\n    ]\r\n  );\r\n\r\n  const hardDisconnect = useCallback(() => {\r\n    try {\r\n      PixelStreamingApp?.removeResponseEventListener?.(\r\n        \"handle_responses\",\r\n        handleResponseApp\r\n      );\r\n    } catch {}\r\n    try {\r\n      PixelStreamingUiApp?.stream?.disconnect?.();\r\n    } catch {}\r\n    try {\r\n      PixelStreamingApp?.disconnect?.();\r\n    } catch {}\r\n\r\n    if (videoWrapRef.current) {\r\n      try {\r\n        const vid = videoWrapRef.current.querySelector(\"video\");\r\n        if (vid) {\r\n          try {\r\n            vid.pause();\r\n          } catch {}\r\n          try {\r\n            vid.srcObject = null;\r\n          } catch {}\r\n          vid.removeAttribute(\"src\");\r\n          try {\r\n            vid.load();\r\n          } catch {}\r\n        }\r\n        videoWrapRef.current.innerHTML = \"\";\r\n      } catch {}\r\n    }\r\n\r\n    setPhase(\"connecting\");\r\n    PixelStreamingApp = undefined;\r\n    PixelStreamingUiApp = undefined;\r\n    UIControlApp = undefined;\r\n  }, [handleResponseApp]);\r\n\r\n  const startPlay = useCallback(async () => {\r\n    if (connectingRef.current) return;\r\n    connectingRef.current = true;\r\n\r\n    // Always begin from a clean slate\r\n    hardDisconnect();\r\n\r\n    const { StreamPixelApplication } = await import(\"streampixelsdk\");\r\n\r\n    // Look up appId from sheet (same row as ?build=)\r\n    let resolvedAppId = \"68d3987ed64e846388bcf314\"; // safe fallback\r\n    try {\r\n      const id = await resolveAppId(buildName);\r\n      resolvedAppId = id || resolvedAppId;\r\n      setResolvedAppIdPreview(resolvedAppId);\r\n      setAppIdError(\"\"); // clear old errors\r\n    } catch (e) {\r\n      const msg = e?.message || String(e);\r\n      console.warn(\"AppId resolve error:\", msg);\r\n      setAppIdError(msg);\r\n      setResolvedAppIdPreview(resolvedAppId + \" (fallback)\");\r\n    }\r\n\r\n    const init = await StreamPixelApplication({\r\n      AutoConnect: true,\r\n      appId: resolvedAppId,\r\n      keyBoardInput: true,\r\n    });\r\n\r\n    const app = init?.appStream || init?.app || init?.stream;\r\n    const ps = init?.pixelStreaming;\r\n    const ui = init?.UIControl;\r\n\r\n    if (!app || !ps) {\r\n      console.error(\"Unexpected SDK shape\", init);\r\n      connectingRef.current = false;\r\n      return;\r\n    }\r\n\r\n    PixelStreamingApp = ps;\r\n    PixelStreamingUiApp = app;\r\n    UIControlApp = ui;\r\n\r\n    // Map SDK lifecycle -> loader phases\r\n    app.onWebRtcConnecting = () => setPhase(\"connecting\");\r\n    app.onVideoInitialized = () => setPhase(\"launching\");\r\n    app.onWebRtcConnected = () => setPhase(\"finalizing\");\r\n\r\n    // Attach immediately\r\n    attachVideoAutoplaySafe(app.rootElement);\r\n\r\n    // Also attach when the SDK fires it\r\n    app.onVideoInitialized = () => {\r\n      setPhase(\"launching\");\r\n      attachVideoAutoplaySafe(app.rootElement);\r\n    };\r\n\r\n    // UE â†’ Web messages\r\n    ps.addResponseEventListener(\"handle_responses\", handleResponseApp);\r\n    console.log(\"added event listener to handle_responses\");\r\n\r\n    // ðŸ” If UE already told us the desired hover state, apply it now\r\n    if (pendingHoverEnabled !== null) {\r\n      try {\r\n        UIControlApp?.toggleHoveringMouse?.(pendingHoverEnabled);\r\n      } catch {}\r\n      try {\r\n        setHoverEnabled(!!pendingHoverEnabled);\r\n      } catch {}\r\n      pendingHoverEnabled = null;\r\n    }\r\n\r\n    try {\r\n      await app.connect?.();\r\n    } catch {}\r\n\r\n    connectingRef.current = false;\r\n  }, [\r\n    attachVideoAutoplaySafe,\r\n    handleResponseApp,\r\n    hardDisconnect,\r\n    buildName,\r\n  ]);\r\n\r\n  const toggleMouseHover = useCallback(() => {\r\n    setHoverEnabled((prev) => {\r\n      const next = !prev;\r\n      UIControlApp?.toggleHoveringMouse?.(next);\r\n      return next;\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    mountedRef.current = true;\r\n    startPlay();\r\n\r\n    // Alt+0 toggle and Backspace OFF fallback\r\n    const onKey = (e) => {\r\n      if (e.code === \"Digit0\" && e.altKey && !e.repeat) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        toggleMouseHover();\r\n        return;\r\n      }\r\n      if (e.code === \"Backspace\" && !e.repeat) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setHoverEnabled(false);\r\n        UIControlApp?.toggleHoveringMouse?.(false);\r\n      }\r\n    };\r\n    window.addEventListener(\"keydown\", onKey, { capture: true });\r\n\r\n    // Track the first REAL user interaction; run queued sequence if needed\r\n    const onPointerDown = (e) => {\r\n  // ignore synthetic events; only real user clicks\r\n  if (!e.isTrusted) return;\r\n\r\n  if (!userInteractedRef.current) {\r\n    userInteractedRef.current = true;\r\n    if (pendingSequenceRef.current) {\r\n      pendingSequenceRef.current = false;\r\n      runIKeyClickSequence();\r\n    }\r\n  }\r\n};\r\n\r\n    window.addEventListener(\"pointerdown\", onPointerDown, { capture: true });\r\n\r\n    // Resume video when tab becomes visible\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") {\r\n        const v = videoWrapRef.current?.querySelector(\"video\");\r\n        v?.play?.().catch(() => {});\r\n      }\r\n    };\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n\r\n    // BFCache return\r\n    const onPageShow = (e) => {\r\n      if (e.persisted) startPlay();\r\n    };\r\n    window.addEventListener(\"pageshow\", onPageShow);\r\n\r\n    // Ensure teardown on hide/unload (helps iOS/Safari)\r\n    const onPageHide = () => {\r\n      hardDisconnect();\r\n    };\r\n    window.addEventListener(\"pagehide\", onPageHide);\r\n\r\n    return () => {\r\n      mountedRef.current = false;\r\n      window.removeEventListener(\"keydown\", onKey, { capture: true });\r\n      window.removeEventListener(\"pointerdown\", onPointerDown, {\r\n        capture: true,\r\n      });\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n      window.removeEventListener(\"pageshow\", onPageShow);\r\n      window.removeEventListener(\"pagehide\", onPageHide);\r\n      hardDisconnect();\r\n    };\r\n  }, [\r\n    startPlay,\r\n    toggleMouseHover,\r\n    hardDisconnect,\r\n    runIKeyClickSequence,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"experience-page\">\r\n      {/* Debug banners */}\r\n      {appIdError && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 10,\r\n            left: 10,\r\n            right: 10,\r\n            zIndex: 10000,\r\n            background: \"#2b1e1e\",\r\n            color: \"#ffb3b3\",\r\n            padding: \"10px 14px\",\r\n            border: \"1px solid #a44\",\r\n            borderRadius: 8,\r\n            fontSize: 14,\r\n          }}\r\n        >\r\n          <b>AppId lookup failed:</b> {appIdError}\r\n        </div>\r\n      )}\r\n      {resolvedAppIdPreview && phase !== \"ready\" && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            top: \"50px\",\r\n            right: \"50px\",\r\n            zIndex: 10000,\r\n            color: \"white\",\r\n            padding: \"8px 12px\",\r\n            borderRadius: 8,\r\n            fontSize: 12,\r\n            transition: \"opacity 300ms ease\",\r\n            opacity: phase === \"ready\" ? 0 : 1,\r\n          }}\r\n        >\r\n          appId: {resolvedAppIdPreview}\r\n        </div>\r\n      )}\r\n\r\n      {/* 3-phase loader overlay + corner text */}\r\n      <LoaderOverlay phase={phase} />\r\n\r\n      <div\r\n        id=\"videoElement\"\r\n        ref={videoWrapRef}\r\n        style={{\r\n          backgroundColor: \"#000\",\r\n          height: \"100vh\",\r\n          position: \"relative\",\r\n          willChange: \"transform\",\r\n        }}\r\n      />\r\n\r\n      {/* Optional manual control */}\r\n      <button\r\n        onClick={toggleMouseHover}\r\n        style={{\r\n          position: \"fixed\",\r\n          bottom: 20,\r\n          right: 20,\r\n          zIndex: 1e7,\r\n          padding: \"8px 12px\",\r\n          borderRadius: 8,\r\n          border: \"1px solid #333\",\r\n          background: \"#1a1a1a\",\r\n          color: \"#fff\",\r\n          cursor: \"pointer\",\r\n        }}\r\n      >\r\n        {hoverEnabled ? \"Mouse Hover: ON (Alt+0)\" : \"Mouse Hover: OFF (Alt+0)\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["GDRIVE_API_URL","getQuery","key","def","arguments","length","undefined","URL","window","location","href","searchParams","get","LOADER_TEXT","connecting","launching","finalizing","toBool","v","s","trim","toLowerCase","PixelStreamingApp","PixelStreamingUiApp","UIControlApp","pendingHoverEnabled","async","resolveAppId","buildName","urlOverride","data","url","params","u","resp","text","Object","entries","forEach","_ref","k","String","set","fetch","toString","method","e","Error","concat","message","clone","json","ok","error","status","_unused","_text","_resp","catch","slice","getJsonVerbose","action","build","appId","LoaderOverlay","_ref2","phase","imgRef","React","scaleX","setScaleX","scaleY","setScaleY","recalc","img","current","naturalWidth","naturalHeight","viewAR","innerWidth","innerHeight","imgAR","onResize","addEventListener","removeEventListener","_jsxs","id","style","position","inset","backgroundColor","display","alignItems","justifyContent","zIndex","overflow","children","_jsx","ref","src","alt","onLoad","width","height","transform","transformOrigin","userSelect","pointerEvents","top","left","maxWidth","color","padding","borderRadius","fontSize","lineHeight","backdropFilter","WebkitBackdropFilter","boxShadow","Experience","videoWrapRef","useRef","connectingRef","mountedRef","hoverEnabled","setHoverEnabled","useState","firstUploadDone","setFirstUploadDone","userInteractedRef","pendingSequenceRef","sequenceRunningRef","setPhase","appIdError","setAppIdError","resolvedAppIdPreview","setResolvedAppIdPreview","useMemo","sessionId","Date","now","filenameFromUrl","fallbackExt","clean","pathname","split","pop","_unused2","toISOString","replace","looksLikeHttpImageUrl","str","test","isHttpInsecure","downloadUrlSmart","useCallback","filenameHint","name","insecureUrl","finalUrl","console","log","open","proxyHttpsDownload","res","mode","blob","a","document","createElement","createObjectURL","download","body","appendChild","click","remove","revokeObjectURL","warn","downloadDataUrl","dataUrl","filename","attachVideoAutoplaySafe","rootEl","innerHTML","append","videoEl","querySelector","muted","autoplay","playsInline","tabIndex","tryPlay","_videoEl$play","play","call","once","onFirstFrame","overlay","getElementById","opacity","setTimeout","unmuteOnce","sendKeyI","_videoWrapRef$current","type","target","evt","KeyboardEvent","code","keyCode","which","bubbles","cancelable","dispatchEvent","sendLeftClick","_videoWrapRef$current2","getBoundingClientRect","rect","cx","cy","makeEvent","MouseEvent","clientX","clientY","button","buttons","runIKeyClickSequence","handleResponseApp","response","forwardImageUrl","val","imageUrl","form","FormData","err","uploadScreenshotUrlToDrive","JSON","parse","_unused3","msg","prototype","hasOwnProperty","_UIControlApp","enabled","showMouseCursor","toggleHoveringMouse","_UIControlApp2","value","savedScreenshotUrl","raw","_val$split$pop","urlFilename","_val$split$pop2","possibleUrl","link","s3Url","ec2Url","http","base64","imageData","png","jpg","startsWith","headers","stringify","imageDataUrl","stamp","then","r","galleryUrl","origin","encodeURIComponent","session","folderId","hardDisconnect","_PixelStreamingApp","_PixelStreamingApp$re","removeResponseEventListener","_unused4","_PixelStreamingUiApp","_PixelStreamingUiApp$","_PixelStreamingUiApp$2","stream","disconnect","_unused5","_PixelStreamingApp2","_PixelStreamingApp2$d","_unused6","vid","pause","_unused7","srcObject","_unused8","removeAttribute","load","_unused9","_unused0","startPlay","StreamPixelApplication","resolvedAppId","init","AutoConnect","keyBoardInput","app","appStream","ps","pixelStreaming","ui","UIControl","onWebRtcConnecting","onVideoInitialized","onWebRtcConnected","rootElement","addResponseEventListener","_UIControlApp3","_UIControlApp3$toggle","_unused1","_unused10","_app$connect","connect","_unused11","toggleMouseHover","prev","_UIControlApp4","_UIControlApp4$toggle","next","useEffect","onKey","altKey","repeat","preventDefault","stopPropagation","_UIControlApp5","_UIControlApp5$toggle","capture","onPointerDown","isTrusted","onVis","visibilityState","_videoWrapRef$current3","_v$play","onPageShow","persisted","onPageHide","className","right","background","border","transition","willChange","onClick","bottom","cursor"],"sourceRoot":""}